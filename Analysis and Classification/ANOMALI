STEP 4 ANALYSIS

4.1 QUALITY EVALUATION CRITERIA

TIMELINESS

CTIPS Count: 8069
select count(*)
from ANOMALI_STIX2;

In place of 2021 was checked also 2020,2019,2018,2017
2021 CTIPS: 82 (1,01%)
2020 CTIPS: 2960 (36,68%)
2019 CTIPS: 1749 (21,67%)
2018 CTIPS: 1632 (20,22%)
2017 CTIPS: 1646 (20,39%)
select count(*)
from ANOMALI_STIX2
where created like '2021%';

COMPLETENESS

Relationships: 75% of fields based on stix2 relationship sro,
missing  fields: start_time,stop_time
contains: type,id,relationship_type,source_ref,target_ref,description + custom external_references,created_by_ref,object_marking_refs
select *
from ANOMALI_STIX2
where objects.type = "relationship"

Identities: 50% of fields based on stix2 identity sdo
contains: type,name,id,identity_class + custom object_marking_refs
missing: roles,description,sectors,contact_info
select *
from ANOMALI_STIX2
where objects.type = "identity"

Course of action: 100% of fields based on stix2 course of action sdo
contains: type,id,name,description + custom object_marking_refs,created_by_ref,external_references,x_mitre_version
select *
from ANOMALI_STIX2
where objects.type = "course-of-action"

Marking Definition:  66,67% of fields based on stix2 marking definition sco
contains: type,id,name,spec_version,created_by_ref,created,definition_type,definition
missing: external_references,object_marking_refs,granular_markings,description
select *
from ANOMALI_STIX2
where objects.type = "marking-definition"

Intrusion Set:  45,45% of fields based on stix2 intrustion set sdo
contains: type,id,name,description,aliases + custom created_by_ref,object_marking_refs,external_references
missing: first_seen,last_seen,goals,resource_level,primary_motivation,secondary_motivations
select *
from ANOMALI_STIX2
where objects.type = "intrusion-set"

Tools:  50% of fields based on stix2 tool sdo
contains: type,id,name,description + custom labels,x_mitre_platforms,x_mitre_aliases,x_mitre_version,external_references,object_marking_refs,created_by_ref
missing: aliases,tool_types, tool_version,kill_chain_phases
select *
from ANOMALI_STIX2
where objects.type = "tool"

Attack Patterns:  83,33% of fields based on stix2 attack pattern sdo
contains: name,description,id,type,kill_chain_phases + custom x_mitre_detection,x_mitre_data_sources,x_mitre_contributors,x_mitre_platforms,object_marking_refs,external_references
missing: aliases
select *
from ANOMALI_STIX2
where objects.type = "attack-pattern"

Malwares: 40% of fields based on stix2 malware sdo
contains: name,type,id,description +external_references,object_marking_refs,created_by_ref,labels,x_mitre_version,x_mitre_aliases,x_mitre_platforms
missing: aliases,last_seen,operating_system_refs,architecture_execution_envs,implementation_languages,capabilities,sample_refs,malware_types,kill_chain_phases
select *
from ANOMALI_STIX2
where objects.type = "malware"

4.2.1 COURSE OF ACTIONS:
select count(*)
from ANOMALI_STIX2
where objects.type = "course-of-action";
Results: 206 (2,55%)

4.2.2 CPE, CVE, CAPEC :
Checked cpe,cve also
select count(*)
from ANOMALI_STIX2
where objects.external_references.url like "%capec%" or objects.external_references.external_id like "%capec%" or objects.external_references.source_name like "%capec%";
Results: 87 CTIPs contained CAPEC (1,07%)

select count(*)
from ANOMALI_STIX2
where objects.external_references.url like "%cve%" or objects.description like "%cve%" or objects.external_references.description like "%cve%" or objects.external_references.source_name like "%cve%"
Results: 86 CTIPs contained CVE (1,06%)

STEP 5 CLASSIFICATION

5.1 Contents of Source:
select distinct(objects.type)
from ANOMALI_STIX2
Results: Tool, Course of action, Intrusion set, Identity, Attack pattern, Relationship, Marking Definition, Malware, X MITRE MATRIX, X MITRE TACTIC

Percentages of SDO's,SRO's,SCO'S*
In place of identity also  Tool, Course of action, Intrusion set, Attack pattern, Relationship, Marking Definition, Malware, X MITRE MATRIX, X MITRE TACTIC
select count(*)
from ANOMALI_STIX2
where objects.type = "identity"
Results: Identity 4 (%), Course of Action 206 (%), Intrusion set 83 (%), Malware 302 (%), Attack pattern 650 (%), Marking definition 4 (%), Relationship 6739 (%), Tool 46 (%),X MITRE MATRIX 1 (%), X MITRE TACTIC 34 (%)

Search specific SDO,SRO
In place of identity also  Tool, Course of action, Intrusion set, Attack pattern, Relationship, Marking Definition, Malware, X MITRE MATRIX, X MITRE TACTIC
select *
from ANOMALI_STIX2
where type = "identity"

5.2 Cyber Kill Chain :
Kill chain phases names,how many per phase name,order desc
select count(*),objects.kill_chain_phases.phase_name
from ANOMALI_STIX2
group by objects.kill_chain_phases.phase_name
order by objects.kill_chain_phases.phase_name desc;
**78 phase names, output omitted.

How many CTIPs included CKC fields: 565 (7%)
select count(*)
from ANOMALI_STIX2
where objects.kill_chain_phases.phase_name like "%%";

Search specific kill chain phase name (in place of technical-information-gathering could be other 77 names)
select *
from ANOMALI_STIX2
where kill_chain_phases.phase_name = 'technical-information-gathering'
